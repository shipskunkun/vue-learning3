### 11 简单轮子：Popover 组件 4 视频

1. 需求分析：

   以提示框的形式，出现在父亲的周围

2. 自己想到的：

   1. 触发方式，鼠标行为， hover, focus， click 出现
   2. 出现位置，父亲的左边，上边，下边，右边
   3. content , 肯定是接受slot 作为渲染内容,  比如slot 是一个 form，或者里面有 确定、取消按钮
   4. trigger， 触发内容（通常是一个button，slot=refer) 和触发后显示内容（slot = content)

问题1 ：

触发方式，传过去了，但是组件中如何确定？

比如我 传给组件，trigger参数是 hover，如何hover的时候触发事件？ 让content slot 内容 visible = true

那如果传过去 click， 父组件中如何，接受触发方式？然后执行？



问题2：

content 如何 以refer元素为父元素进行定位？

比如，当 refer 顶部距离不够的时候，content 应该围绕在 refer 下面展示



#### 11-1 开始popover组件

看了代码中思路：

在全局 body 中挂载 slot = content 元素 div，display:none， z-index = 999

不是在 refer 的孩子结构中挂的



问题1思路：

给父组件中传入事件名称，父组件如何触发？

解决办法：接受触发方式值，然后给dom 元素绑定响应的函数，比如接受hover, addEventListener click



问题2思路：

在点击 trigger元素后，我们把 展示内容 content ，挂载到 body 中

获取 trigger 元素 getBoundingClientRect，距离可视区域，上下左右距离

 计算，content 位置。

示例： content 在 trigger 元素上方弹出， top = tigger  高度 - content 高度/2





注意点：

我们给 document绑定事件时候，需要判断，点击事件发生元素是否在 trigger Dom 中

1. Dom 元素，contains 使用，检测当前DOM对象返回的节点中的子节点是否包含指定节点



什么时候不要关闭？

如果点击元素在 popover 元素中，不要关闭



什么时候关闭 content？

 点击页面其他区域元素、点击 trigger元素，关闭

点击content元素，不关闭

这里需要判断，e.target 是不是 content 中



使用：看 demo 代码

```vue
<template>
  <div class="popover" ref="popover">
    <div ref="contentWrapper" class="gulu-popover-content-wrapper" v-if="visible">
      <slot name="content" :close="close"></slot>  //content  slot 
    </div>
    <span ref="triggerWrapper" style="display: inline-block;">
      <slot></slot>      //trigger  content 
    </span>
  </div>
</template>

<g-popover>
  <g-button>上方弹出</g-button>   // 默认是 trigger slot
  <template slot="content">
弹出内容
  </template>
</g-popover>
```



问题2

为什么 destroy 的时候，把 content 放到  trigger 元素里面？



问题3

为什么，不是把 content  append 到 trigger元素中呢？

然后 content 位置，相对于 trigger 绝对定位，而不是 body 绝对定位？



问题4 子元素绝对定位位置

想想子元素居中父元素，怎么做的即可。

positon: absolute

bottom: 100%    是父亲的高度。



11-2 解决新手常见的三个问题

11-3 支持四个方位

11-4 支持click和hover两种方式